<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.qqbot.mapper.DiceLogMapper" >
    <resultMap id="DiceLogItem" type="org.qqbot.entity.DiceLogItem" >
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="timestamp" property="timestamp" jdbcType="CHAR" />
        <result column="sender_name" property="senderName" jdbcType="CHAR" />
        <result column="sender_id" property="senderId" jdbcType="CHAR" />
        <result column="log" property="log" jdbcType="CHAR" />
    </resultMap>


    <select id="getSenderDiceLog" resultMap="DiceLogItem" >
        SELECT `id`, `timestamp`, `sender_name`, `sender_id`, `log`
	    FROM dice_log
        WHERE `sender_id` = #{senderId}
        ORDER BY `timestamp` DESC
        LIMIT 3
    </select>

    <insert id="insertDiceLog" useGeneratedKeys="true" keyProperty="id"  parameterType="org.qqbot.entity.DiceLogItem" >
        INSERT INTO `dice_log`(`timestamp`, `sender_name`, `sender_id`, `log`)
        VALUE (#{timestamp}, #{senderName}, #{senderId}, #{log})
    </insert>

</mapper>